<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç”Ÿç‰©å­¦è¯„ä¼° Â· ä½“æ£€æŠ¥å‘Šä¸Šä¼  | é™†å¤§å¤«</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;600&family=Noto+Sans+SC:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #1a1a1a;
    --ink-light: #444;
    --ink-faint: #888;
    --gold: #b8860b;
    --gold-light: #d4a017;
    --cream: #faf8f3;
    --white: #ffffff;
    --border: #e8e2d4;
    --green: #27ae60;
    --blue: #2980b9;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Noto Sans SC', sans-serif;
    background: var(--cream);
    color: var(--ink);
    min-height: 100vh;
    padding: 20px;
  }
  .container {
    max-width: 600px;
    margin: 0 auto;
  }
  .header {
    text-align: center;
    padding: 32px 0 28px;
    border-bottom: 2px solid var(--gold);
    margin-bottom: 32px;
  }
  .header h1 {
    font-family: 'Noto Serif SC', serif;
    font-size: 24px;
    font-weight: 300;
    letter-spacing: 3px;
    margin-bottom: 8px;
  }
  .header p {
    font-size: 13px;
    color: var(--ink-faint);
    letter-spacing: 1px;
  }
  
  .card {
    background: var(--white);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 28px 24px;
    margin-bottom: 20px;
  }
  .card h2 {
    font-family: 'Noto Serif SC', serif;
    font-size: 17px;
    margin-bottom: 16px;
    color: var(--ink);
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .card-icon {
    font-size: 20px;
  }
  
  .info-list {
    list-style: none;
    margin-top: 16px;
  }
  .info-item {
    padding: 10px 0;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: flex-start;
    gap: 10px;
    font-size: 13px;
    line-height: 1.7;
    color: var(--ink-light);
  }
  .info-item:last-child { border-bottom: none; }
  .info-item-icon {
    font-size: 14px;
    color: var(--gold);
    margin-top: 2px;
  }
  
  .form-group {
    margin-bottom: 20px;
  }
  .form-label {
    font-size: 13px;
    color: var(--ink);
    margin-bottom: 8px;
    display: block;
    font-weight: 500;
  }
  .form-input {
    width: 100%;
    padding: 12px 16px;
    border: 1px solid var(--border);
    border-radius: 8px;
    font-size: 14px;
    font-family: inherit;
    outline: none;
    transition: border-color 0.2s;
  }
  .form-input:focus { border-color: var(--gold); }
  
  .upload-zone {
    border: 2px dashed var(--border);
    border-radius: 12px;
    padding: 32px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
    background: var(--cream);
  }
  .upload-zone:hover {
    border-color: var(--gold);
    background: #fffdf7;
  }
  .upload-zone.dragging {
    border-color: var(--gold);
    background: #fffdf7;
  }
  .upload-icon {
    font-size: 48px;
    margin-bottom: 12px;
  }
  .upload-text {
    font-size: 14px;
    color: var(--ink-light);
    margin-bottom: 6px;
  }
  .upload-hint {
    font-size: 11px;
    color: var(--ink-faint);
  }
  
  .file-list {
    margin-top: 16px;
  }
  .file-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background: var(--cream);
    border-radius: 8px;
    margin-bottom: 8px;
  }
  .file-icon {
    font-size: 24px;
  }
  .file-info {
    flex: 1;
  }
  .file-name {
    font-size: 13px;
    color: var(--ink);
    margin-bottom: 2px;
  }
  .file-size {
    font-size: 11px;
    color: var(--ink-faint);
  }
  .file-remove {
    font-size: 18px;
    color: var(--ink-faint);
    cursor: pointer;
    transition: color 0.2s;
  }
  .file-remove:hover { color: #c0392b; }
  
  .btn {
    width: 100%;
    padding: 16px;
    background: var(--ink);
    color: var(--white);
    border: 2px solid var(--gold);
    border-radius: 8px;
    font-size: 15px;
    font-family: 'Noto Serif SC', serif;
    letter-spacing: 2px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn:hover {
    background: var(--gold);
    color: var(--ink);
  }
  .btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  .success-panel {
    display: none;
    text-align: center;
    padding: 40px 20px;
  }
  .success-icon {
    font-size: 64px;
    margin-bottom: 20px;
  }
  .success-title {
    font-family: 'Noto Serif SC', serif;
    font-size: 20px;
    margin-bottom: 12px;
    color: var(--green);
  }
  .success-text {
    font-size: 14px;
    color: var(--ink-light);
    line-height: 1.8;
    margin-bottom: 24px;
  }
  
  .price-tag {
    display: inline-block;
    background: rgba(184,134,11,0.1);
    color: var(--gold);
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    margin-left: 8px;
  }
  
  .timeline {
    margin-top: 20px;
  }
  .timeline-item {
    display: flex;
    gap: 14px;
    margin-bottom: 16px;
  }
  .timeline-dot {
    width: 24px;
    height: 24px;
    background: var(--gold);
    border-radius: 50%;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    color: var(--ink);
    font-weight: 600;
  }
  .timeline-content {
    flex: 1;
    padding-top: 2px;
  }
  .timeline-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--ink);
    margin-bottom: 3px;
  }
  .timeline-desc {
    font-size: 12px;
    color: var(--ink-faint);
    line-height: 1.5;
  }
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>ç¬¬äºŒå±‚ Â· ç”Ÿç‰©å­¦è¯„ä¼°</h1>
    <p>Biological Biomarker Assessment</p>
  </div>
  
  <div id="upload-form">
    <!-- æœåŠ¡è¯´æ˜ -->
    <div class="card">
      <h2><span class="card-icon">ğŸ”¬</span> æœåŠ¡å†…å®¹<span class="price-tag">Â¥699</span></h2>
      <ul class="info-list">
        <li class="info-item">
          <span class="info-item-icon">âœ“</span>
          <span>åŸºäºä½ çš„è¡€æ¶²ç”ŸåŒ–æŒ‡æ ‡ï¼Œè®¡ç®—ç²¾ç¡®ç”Ÿç‰©å¹´é¾„ï¼ˆè¯¯å·®Â±1å²ï¼‰</span>
        </li>
        <li class="info-item">
          <span class="info-item-icon">âœ“</span>
          <span>åˆ†æç‚ç—‡ã€ä»£è°¢ã€å¿ƒè¡€ç®¡ã€æ¿€ç´ å››å¤§ç³»ç»Ÿè€åŒ–é€Ÿåº¦</span>
        </li>
        <li class="info-item">
          <span class="info-item-icon">âœ“</span>
          <span>ç”Ÿæˆ12é¡µä¸“ä¸šæŠ¥å‘Š + é™†å¤§å¤«15åˆ†é’Ÿ1å¯¹1è§†é¢‘è§£è¯»</span>
        </li>
        <li class="info-item">
          <span class="info-item-icon">âœ“</span>
          <span>æä¾›ä¸ªæ€§åŒ–å¹²é¢„æ–¹æ¡ˆï¼ˆè¥å…»ã€è¿åŠ¨ã€è¡¥å……å‰‚ï¼‰</span>
        </li>
      </ul>
    </div>
    
    <!-- éœ€è¦ä¸Šä¼ çš„æŠ¥å‘Š -->
    <div class="card">
      <h2><span class="card-icon">ğŸ“‹</span> éœ€è¦ä¸Šä¼ çš„æ£€æµ‹æŠ¥å‘Š</h2>
      <ul class="info-list">
        <li class="info-item">
          <span class="info-item-icon">â‘ </span>
          <span><strong>è¡€å¸¸è§„</strong>ï¼ˆå¿…é¡»ï¼‰ï¼šè¡€çº¢è›‹ç™½ã€ç™½ç»†èƒã€è¡€å°æ¿ç­‰</span>
        </li>
        <li class="info-item">
          <span class="info-item-icon">â‘¡</span>
          <span><strong>ç”ŸåŒ–å…¨å¥—</strong>ï¼ˆå¿…é¡»ï¼‰ï¼šè¡€ç³–ã€è¡€è„‚ã€è‚è‚¾åŠŸèƒ½ã€å°¿é…¸ç­‰</span>
        </li>
        <li class="info-item">
          <span class="info-item-icon">â‘¢</span>
          <span><strong>ç‚ç—‡æŒ‡æ ‡</strong>ï¼ˆæ¨èï¼‰ï¼šCRPã€ESRã€é“è›‹ç™½ç­‰</span>
        </li>
        <li class="info-item">
          <span class="info-item-icon">â‘£</span>
          <span><strong>æ¿€ç´ æ£€æµ‹</strong>ï¼ˆå¯é€‰ï¼‰ï¼šç”²çŠ¶è…ºã€æ€§æ¿€ç´ ã€çš®è´¨é†‡ç­‰</span>
        </li>
      </ul>
      <p style="font-size:11px;color:var(--ink-faint);margin-top:12px;font-style:italic;">
        âš ï¸ æŠ¥å‘Šéœ€åœ¨6ä¸ªæœˆå†…ï¼Œå¦‚æ— è¿‘æœŸä½“æ£€ï¼Œæˆ‘ä»¬å¯æ¨èåˆä½œæ£€æµ‹æœºæ„
      </p>
    </div>
    
    <!-- ä¸ªäººä¿¡æ¯ -->
    <div class="card">
      <h2><span class="card-icon">ğŸ‘¤</span> åŸºæœ¬ä¿¡æ¯</h2>
      <div class="form-group">
        <label class="form-label">å§“åï¼ˆä»…ç”¨äºæŠ¥å‘Šç”Ÿæˆï¼‰</label>
        <input type="text" class="form-input" id="userName" placeholder="è¯·è¾“å…¥å§“å">
      </div>
      <div class="form-group">
        <label class="form-label">æ‰‹æœºå·ï¼ˆç”¨äºå‘é€æŠ¥å‘Šå’Œé¢„çº¦è§£è¯»ï¼‰</label>
        <input type="tel" class="form-input" id="userPhone" placeholder="è¯·è¾“å…¥æ‰‹æœºå·">
      </div>
      <div class="form-group">
        <label class="form-label">å¾®ä¿¡å·ï¼ˆå¿…å¡«ï¼Œç”¨äº1å¯¹1è§£è¯»æ²Ÿé€šï¼‰</label>
        <input type="text" class="form-input" id="userWechat" placeholder="è¯·è¾“å…¥å¾®ä¿¡å·">
      </div>
    </div>
    
    <!-- ä¸Šä¼ åŒºåŸŸ -->
    <div class="card">
      <h2><span class="card-icon">ğŸ“¤</span> ä¸Šä¼ ä½“æ£€æŠ¥å‘Š</h2>
      <input type="file" id="fileInput" accept="image/*,application/pdf" multiple style="display:none">
      <div class="upload-zone" id="uploadZone">
        <div class="upload-icon">ğŸ“„</div>
        <div class="upload-text">ç‚¹å‡»ä¸Šä¼  æˆ– æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ</div>
        <div class="upload-hint">æ”¯æŒ JPGã€PNGã€PDF æ ¼å¼ï¼Œå•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡10MB</div>
      </div>
      <div class="file-list" id="fileList"></div>
    </div>
    
    <!-- äº¤ä»˜æµç¨‹ -->
    <div class="card">
      <h2><span class="card-icon">â±ï¸</span> äº¤ä»˜æµç¨‹</h2>
      <div class="timeline">
        <div class="timeline-item">
          <div class="timeline-dot">1</div>
          <div class="timeline-content">
            <div class="timeline-title">ä¸Šä¼ æŠ¥å‘Šå¹¶æ”¯ä»˜</div>
            <div class="timeline-desc">æäº¤å24å°æ—¶å†…æ”¶åˆ°ç¡®è®¤æ¶ˆæ¯</div>
          </div>
        </div>
        <div class="timeline-item">
          <div class="timeline-dot">2</div>
          <div class="timeline-content">
            <div class="timeline-title">é™†å¤§å¤«å®¡æ ¸ä¸è®¡ç®—</div>
            <div class="timeline-desc">3-5ä¸ªå·¥ä½œæ—¥å®Œæˆæ•°æ®åˆ†æ</div>
          </div>
        </div>
        <div class="timeline-item">
          <div class="timeline-dot">3</div>
          <div class="timeline-content">
            <div class="timeline-title">å‘é€æŠ¥å‘Š + é¢„çº¦è§£è¯»</div>
            <div class="timeline-desc">PDFæŠ¥å‘Š + 15åˆ†é’Ÿè§†é¢‘è§£è¯»ï¼ˆå¾®ä¿¡è§†é¢‘é€šè¯ï¼‰</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- æäº¤æŒ‰é’® -->
    <button class="btn" id="submitBtn" disabled>æäº¤æŠ¥å‘Šå¹¶æ”¯ä»˜ Â¥699</button>
  </div>
  
  <!-- æˆåŠŸé¡µé¢ -->
  <div id="successPanel" class="success-panel">
    <div class="success-icon">âœ…</div>
    <h3 class="success-title">æŠ¥å‘Šå·²æˆåŠŸæäº¤ï¼</h3>
    <p class="success-text">
      æˆ‘ä»¬å·²æ”¶åˆ°æ‚¨çš„ä½“æ£€æŠ¥å‘Š<br>
      é™†å¤§å¤«å°†åœ¨24å°æ—¶å†…é€šè¿‡å¾®ä¿¡ä¸æ‚¨ç¡®è®¤<br>
      é¢„è®¡3-5ä¸ªå·¥ä½œæ—¥å®Œæˆåˆ†æå¹¶å‘é€å®Œæ•´æŠ¥å‘Š
    </p>
    <button class="btn" onclick="window.location.href='https://nanoviga.com'">è¿”å›é¦–é¡µ</button>
  </div>
</div>

<!-- CloudBase SDK -->
<script src="https://imgcache.qq.com/qcloud/cloudbase-js-sdk/1.7.0/cloudbase.full.js"></script>
<script>
  // CloudBase é…ç½®
  const CLOUDBASE_ENV_ID = 'bioage-prod-0g1fctv0d133967d'; // æ›¿æ¢ä¸ºä½ çš„ç¯å¢ƒID
  
  const app = cloudbase.init({ env: CLOUDBASE_ENV_ID });
  const auth = app.auth();
  const db = app.database();
  const storage = app.uploadFile;
  
  // æ–‡ä»¶ç®¡ç†
  let uploadedFiles = [];
  
  // å…ƒç´ 
  const uploadZone = document.getElementById('uploadZone');
  const fileInput = document.getElementById('fileInput');
  const fileList = document.getElementById('fileList');
  const submitBtn = document.getElementById('submitBtn');
  const userName = document.getElementById('userName');
  const userPhone = document.getElementById('userPhone');
  const userWechat = document.getElementById('userWechat');
  
  // ç‚¹å‡»ä¸Šä¼ 
  uploadZone.addEventListener('click', () => fileInput.click());
  
  // æ‹–æ‹½ä¸Šä¼ 
  uploadZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadZone.classList.add('dragging');
  });
  uploadZone.addEventListener('dragleave', () => {
    uploadZone.classList.remove('dragging');
  });
  uploadZone.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadZone.classList.remove('dragging');
    handleFiles(e.dataTransfer.files);
  });
  
  // æ–‡ä»¶é€‰æ‹©
  fileInput.addEventListener('change', (e) => {
    handleFiles(e.target.files);
  });
  
  // å¤„ç†æ–‡ä»¶
  function handleFiles(files) {
    Array.from(files).forEach(file => {
      if (file.size > 10 * 1024 * 1024) {
        alert('æ–‡ä»¶ ' + file.name + ' è¶…è¿‡10MBï¼Œè¯·å‹ç¼©åä¸Šä¼ ');
        return;
      }
      uploadedFiles.push(file);
      renderFileList();
    });
  }
  
  // æ¸²æŸ“æ–‡ä»¶åˆ—è¡¨
  function renderFileList() {
    fileList.innerHTML = uploadedFiles.map((file, idx) => `
      <div class="file-item">
        <div class="file-icon">${file.type.includes('pdf') ? 'ğŸ“•' : 'ğŸ“·'}</div>
        <div class="file-info">
          <div class="file-name">${file.name}</div>
          <div class="file-size">${(file.size / 1024).toFixed(0)} KB</div>
        </div>
        <div class="file-remove" onclick="removeFile(${idx})">âœ•</div>
      </div>
    `).join('');
    validateForm();
  }
  
  // åˆ é™¤æ–‡ä»¶
  function removeFile(idx) {
    uploadedFiles.splice(idx, 1);
    renderFileList();
  }
  
  // è¡¨å•éªŒè¯
  function validateForm() {
    const valid = userName.value.trim() 
      && userPhone.value.trim() 
      && userWechat.value.trim()
      && uploadedFiles.length > 0;
    submitBtn.disabled = !valid;
  }
  
  userName.addEventListener('input', validateForm);
  userPhone.addEventListener('input', validateForm);
  userWechat.addEventListener('input', validateForm);
  
  // æäº¤
  submitBtn.addEventListener('click', async () => {
    submitBtn.disabled = true;
    submitBtn.textContent = 'ä¸Šä¼ ä¸­...';
    
    try {
      // åŒ¿åç™»å½•
      await auth.anonymousAuthProvider().signIn();
      
      // ä¸Šä¼ æ–‡ä»¶åˆ°äº‘å­˜å‚¨
      const fileUrls = [];
      for (let file of uploadedFiles) {
        const res = await app.uploadFile({
          cloudPath: `reports/${Date.now()}_${file.name}`,
          filePath: file
        });
        fileUrls.push(res.fileID);
      }
      
      // ä¿å­˜åˆ°æ•°æ®åº“
      await db.collection('layer2_assessments').add({
        userName: userName.value.trim(),
        userPhone: userPhone.value.trim(),
        userWechat: userWechat.value.trim(),
        reportFiles: fileUrls,
        status: 'pending',
        createdAt: new Date(),
        source: new URLSearchParams(window.location.search).get('from') || 'direct'
      });
      
      // æ˜¾ç¤ºæˆåŠŸé¡µé¢
      document.getElementById('upload-form').style.display = 'none';
      document.getElementById('successPanel').style.display = 'block';
      
    } catch (err) {
      alert('æäº¤å¤±è´¥ï¼š' + err.message);
      submitBtn.disabled = false;
      submitBtn.textContent = 'æäº¤æŠ¥å‘Šå¹¶æ”¯ä»˜ Â¥699';
    }
  });
</script>

</body>
</html>
